"use strict";(self.webpackChunkude_a_io_t_page=self.webpackChunkude_a_io_t_page||[]).push([[1504],{1408:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>l,contentTitle:()=>d,default:()=>h,frontMatter:()=>i,metadata:()=>c,toc:()=>t});var s=r(7624),a=r(4552);r(6212),r(2440),r(6968);const i={sidebar_label:"Ejemplo 2"},d="Ejemplo 2 - Conexi\xf3n de un teclado matricial 4x4 a un ESP32",c={id:"sesiones/percepcion/sesion5c",title:"Ejemplo 2 - Conexi\xf3n de un teclado matricial 4x4 a un ESP32",description:"Resumen",source:"@site/docs/sesiones/percepcion/sesion5c.md",sourceDirName:"sesiones/percepcion",slug:"/sesiones/percepcion/sesion5c",permalink:"/UdeA_IoT-page/docs/sesiones/percepcion/sesion5c",draft:!1,unlisted:!1,editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/sesiones/percepcion/sesion5c.md",tags:[],version:"current",frontMatter:{sidebar_label:"Ejemplo 2"},sidebar:"sesionesSidebar",previous:{title:"Ejemplo 1",permalink:"/UdeA_IoT-page/docs/sesiones/percepcion/sesion5b"},next:{title:"Introducci\xf3n",permalink:"/UdeA_IoT-page/docs/sesiones/percepcion/sesion5d_1"}},l={},t=[{value:"Resumen",id:"resumen",level:2},{value:"Hardware",id:"hardware",level:2},{value:"Componentes",id:"componentes",level:3},{value:"Esquematico",id:"esquematico",level:3},{value:"Diagrama de conexi\xf3n",id:"diagrama-de-conexi\xf3n",level:3},{value:"Software",id:"software",level:2},{value:"Configuraci\xf3n en Platformio",id:"configuraci\xf3n-en-platformio",level:3},{value:"Otros recursos",id:"otros-recursos",level:2},{value:"Referencias",id:"referencias",level:2}];function o(e){const n={a:"a",blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",h3:"h3",img:"img",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,a.M)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.h1,{id:"ejemplo-2---conexi\xf3n-de-un-teclado-matricial-4x4-a-un-esp32",children:"Ejemplo 2 - Conexi\xf3n de un teclado matricial 4x4 a un ESP32"}),"\n",(0,s.jsx)(n.h2,{id:"resumen",children:"Resumen"}),"\n",(0,s.jsxs)(n.p,{children:["Realizar una aplicaci\xf3n para el ESP32 que despliegue serialmente todas las teclas de un teclado matricial 4x4 escepto las que se asocian a las teclas ",(0,s.jsx)(n.strong,{children:(0,s.jsx)(n.code,{children:"#"})})," y ",(0,s.jsx)(n.strong,{children:(0,s.jsx)(n.code,{children:"*"})}),". El comportamiento cuando se precione alguna de las teclas ser\xe1, encender y apagar el led que viene integrado con la tarjeta de tal manera que una de estas lo apaga, la otra lo prenda."]}),"\n",(0,s.jsx)(n.h2,{id:"hardware",children:"Hardware"}),"\n",(0,s.jsx)(n.h3,{id:"componentes",children:"Componentes"}),"\n",(0,s.jsx)(n.p,{children:"La siguiente tabla muestra los componentes principales del circuito a montar:"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Componentes"}),(0,s.jsx)(n.th,{children:"Cantidad"}),(0,s.jsx)(n.th,{children:"Observaciones"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"ESP32"}),(0,s.jsx)(n.td,{children:"1"}),(0,s.jsx)(n.td,{})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"Teclado matricial de membrana"}),(0,s.jsx)(n.td,{children:"1"}),(0,s.jsxs)(n.td,{children:["Disponible en el kit Elegoo (",(0,s.jsx)(n.a,{href:"https://cdn.sparkfun.com/assets/f/f/a/5/0/DS-16038.pdf",children:"datasheet"}),")"]})]})]})]}),"\n",(0,s.jsx)(n.p,{children:"Es importante conocer los pines del teclado matricial antes de empezar. A continuaci\xf3n se muestra un mapa de estos:"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{alt:"conexion",src:r(3024).c+"",width:"765",height:"1311"})}),"\n",(0,s.jsx)(n.h3,{id:"esquematico",children:"Esquematico"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{alt:"esquematico",src:r(4164).c+"",width:"750",height:"768"})}),"\n",(0,s.jsx)(n.h3,{id:"diagrama-de-conexi\xf3n",children:"Diagrama de conexi\xf3n"}),"\n",(0,s.jsx)(n.p,{children:"La conexi\xf3n entre teclado matricial de membrana de 4x4 y el ESP32 se muestra en la siguiente tabla:"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"ESP32"}),(0,s.jsx)(n.th,{children:"Teclado matricial 4x4"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"P23 (GPIO23)"}),(0,s.jsx)(n.td,{children:"R1"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"P22 (GPIO22)"}),(0,s.jsx)(n.td,{children:"R2"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"P21 (GPIO21)"}),(0,s.jsx)(n.td,{children:"R3"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"P19 (GPIO19)"}),(0,s.jsx)(n.td,{children:"R4"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"P5 (GPIO5)"}),(0,s.jsx)(n.td,{children:"C1"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"P17 (GPIO17)"}),(0,s.jsx)(n.td,{children:"C2"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"P16 (GPIO16)"}),(0,s.jsx)(n.td,{children:"C3"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"P4 (GPIO4)"}),(0,s.jsx)(n.td,{children:"C4"})]})]})]}),"\n",(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Archivo Fritzing"}),"\r\nEl archivo Fritzing asociado al proyecto es ",(0,s.jsx)(n.strong,{children:"esp32_keypad.fzz"})," ",(0,s.jsx)(n.a,{target:"_blank","data-noBrokenLinkCheck":!0,href:r(5672).c+"",children:"[descargar]"})]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"software",children:"Software"}),"\n",(0,s.jsx)(n.h3,{id:"configuraci\xf3n-en-platformio",children:"Configuraci\xf3n en Platformio"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["Crear y configurar el proyecto (en nuestro caso se llamo ",(0,s.jsx)(n.strong,{children:"test-keypad_ESP32"}),"), en nuestro caso se utilizaron los siguientes parametros:"]}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Par\xe1metro"}),(0,s.jsx)(n.th,{children:"Valor"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"Name"})}),(0,s.jsx)(n.td,{children:"test-keypad_ESP32"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"Board"})}),(0,s.jsx)(n.td,{children:"NodeMCU-32S"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"Framework"})}),(0,s.jsx)(n.td,{children:"Arduino"})]})]})]}),"\n",(0,s.jsx)(n.p,{children:"El resultado de esto se muestra en la siguiente figura:"}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["Agregue las librerias necesarias y sus dependencias (esto ultimo se hace de manera automatica). En nuestro caso se instalo la libreria ",(0,s.jsx)(n.strong,{children:"Keypad"}),". Para ello se siguen los siguientes pasos:"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["Buscar la libreria por el nombre (",(0,s.jsx)(n.strong,{children:"Keypad"})," en nuestro caso). Si todo esta bien aparecera una lista de librerias:"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{alt:"2",src:r(4624).c+"",width:"1344",height:"626"})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["Seleccionar de la lista, la libreria que se quiere agregar (",(0,s.jsx)(n.strong,{children:"Keypad"})," en nuestro caso), luego, proceder a agregarla al proyecto."]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{alt:"3",src:r(2268).c+"",width:"1087",height:"653"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["De la lista de proyectos que aparecen, seleccionar el proyecto en el cual se quiere agregar esta. Para este ejemplo, el proyecto a elegir es ",(0,s.jsx)(n.strong,{children:"test-keypad_ESP32"}),"."]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{alt:"4",src:r(520).c+"",width:"697",height:"420"})}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:["Una vez el proceso de agregar las librerias necesarias se ha completado, el archivo\r\n",(0,s.jsx)(n.a,{target:"_blank","data-noBrokenLinkCheck":!0,href:r(5620).c+"",children:(0,s.jsx)(n.strong,{children:"platformio.ini"})})," quedo actualizado con la informaci\xf3n de las librerias:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ini",children:"; PlatformIO Project Configuration File\r\n;\r\n;   Build options: build flags, source filter\r\n;   Upload options: custom upload port, speed and extra flags\r\n;   Library options: dependencies, extra library storages\r\n;   Advanced options: extra scripting\r\n;\r\n; Please visit documentation for the other options and examples\r\n; https://docs.platformio.org/page/projectconf.html\r\n\r\n[env:nodemcu-32s]\r\nplatform = espressif32\r\nboard = nodemcu-32s\r\nframework = arduino\r\nlib_deps = chris--a/Keypad@^3.1.1\n"})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["Proceda a codificar el programa en el archivo ",(0,s.jsx)(n.a,{target:"_blank","data-noBrokenLinkCheck":!0,href:r(2124).c+"",children:(0,s.jsx)(n.strong,{children:"main.cpp"})}),". El cual para nuestro caso queda de la siguiente manera:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-cpp",children:"#include <Arduino.h>\r\n#include <Keypad.h>\r\n\r\nconst byte ROWS = 4; // Four rows\r\nconst byte COLS = 4; // Three columns\r\n\r\n// Define the Keymap\r\nchar keys[ROWS][COLS] = {\r\n  {'1','2','3','A'},\r\n  {'4','5','6','B'},\r\n  {'7','8','9','C'},\r\n  {'#','0','*','D'}\r\n};\r\n\r\n// Conections ESP32 - Keypad\r\n#define ROW1 23\r\n#define ROW2 22\r\n#define ROW3 21\r\n#define ROW4 19\r\n#define COL1 5\r\n#define COL2 17\r\n#define COL3 16\r\n#define COL4 4\r\n\r\n// Connect keypad ROW1, ROW2, ROW3 and ROW4 to these Arduino pins.\r\nbyte rowPins[ROWS] = { ROW1, ROW2, ROW3, ROW4 };\r\n// Connect keypad COL0, COL1, COL2 and COL3 to these Arduino pins.\r\nbyte colPins[COLS] = { COL1, COL2, COL3, COL4 }; \r\n\r\n// Create the Keypad\r\nKeypad kpd = Keypad( makeKeymap(keys), rowPins, colPins, ROWS, COLS );\r\n\r\nconst int ledpin = 2;\r\n\r\nvoid setup()\r\n{\r\n  pinMode(ledpin,OUTPUT);\r\n  digitalWrite(ledpin, HIGH);\r\n  Serial.begin(9600);\r\n  Serial.println(\"System Ok...\");\r\n}\r\n\r\nvoid loop()\r\n{\r\n  char key = kpd.getKey();\r\n  if(key)  // Check for a valid key.\r\n  {\r\n    switch (key)\r\n    {\r\n      case '*':\r\n        digitalWrite(ledpin, LOW);\r\n        break;\r\n      case '#':\r\n        digitalWrite(ledpin, HIGH);\r\n        break;\r\n      default:\r\n        Serial.println(key);\r\n    }\r\n  }\r\n}\n"})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"Compile el programa para verificar si hay errores."}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{alt:"5",src:r(8580).c+"",width:"1007",height:"696"})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"Si no hay errores, proceda a subir el programa a la ESP32."}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{alt:"6",src:r(9432).c+"",width:"1013",height:"694"})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"Si todo sale bien ya puede proceder a probar el programa. Como el ejemplo usa comunicaci\xf3n serial, proceda a abrir la terminal serial:"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{alt:"8",src:r(1844).c+"",width:"1015",height:"329"})}),"\n",(0,s.jsxs)(n.p,{children:["Para salir de la terminal serial use la combinaci\xf3n de teclas ",(0,s.jsxs)(n.strong,{children:[(0,s.jsx)(n.code,{children:"CTRL"})," + ",(0,s.jsx)(n.code,{children:"C"})]}),"."]}),"\n",(0,s.jsxs)(n.p,{children:["Opcionalmente, tambien puede hacer uso del ",(0,s.jsx)(n.strong,{children:"monitor serial"})," para un mejor debug. La siguiente figura muestra esto:"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{alt:"8",src:r(6580).c+"",width:"1021",height:"377"})}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"otros-recursos",children:"Otros recursos"}),"\n",(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Simulaci\xf3n online"}),"\r\nLa simulaci\xf3n del programa descargado se encuentra en (",(0,s.jsx)(n.a,{href:"https://wokwi.com/projects/375583898825876481",children:"link"}),")"]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"referencias",children:"Referencias"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://playground.arduino.cc/Main/KeypadTutorial/",children:"https://playground.arduino.cc/Main/KeypadTutorial/"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://learn.adafruit.com/matrix-keypad",children:"https://learn.adafruit.com/matrix-keypad"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://randomnerdtutorials.com/arduino-membrane-keypad-tutorial/",children:"https://randomnerdtutorials.com/arduino-membrane-keypad-tutorial/"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://www.luisllamas.es/arduino-teclado-matricial/",children:"https://www.luisllamas.es/arduino-teclado-matricial/"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://www.circuitbasics.com/how-to-set-up-a-keypad-on-an-arduino/",children:"https://www.circuitbasics.com/how-to-set-up-a-keypad-on-an-arduino/"})}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,a.M)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(o,{...e})}):o(e)}},5672:(e,n,r)=>{r.d(n,{c:()=>s});const s=r.p+"assets/files/esp32_keypad-a051af55066a269e5178e8d6047da7e8.fzz"},2124:(e,n,r)=>{r.d(n,{c:()=>s});const s=r.p+"assets/files/main-29f8d6cee2cd847de0bf436846fd2af7.cpp"},5620:(e,n,r)=>{r.d(n,{c:()=>s});const s=r.p+"assets/files/platformio-765d29e1a9cb2d5b35e26036c86f5a0a.ini"},3024:(e,n,r)=>{r.d(n,{c:()=>s});const s=r.p+"assets/images/esp32_keypad_bb-8cb1f9f2ef7b06564eada67aada96e8a.png"},4164:(e,n,r)=>{r.d(n,{c:()=>s});const s=r.p+"assets/images/esp32_keypad_sch-57b674bc29a662b8ba684a3e0e04598b.png"},4624:(e,n,r)=>{r.d(n,{c:()=>s});const s=r.p+"assets/images/example_keypad2-1db9c9f2572834af10f454e0653657ef.png"},2268:(e,n,r)=>{r.d(n,{c:()=>s});const s=r.p+"assets/images/example_keypad3-0298111ae4bbdb1bbb30a1b858d3f3a8.png"},520:(e,n,r)=>{r.d(n,{c:()=>s});const s=r.p+"assets/images/example_keypad4-e24fb2a015088c9ed4ae25f7a8ea88f2.png"},8580:(e,n,r)=>{r.d(n,{c:()=>s});const s=r.p+"assets/images/example_keypad5-49b592ea515a4e744fd490a4a464d986.png"},9432:(e,n,r)=>{r.d(n,{c:()=>s});const s=r.p+"assets/images/example_keypad6-b5a0886a4adc67bc077305c4f76e2958.png"},1844:(e,n,r)=>{r.d(n,{c:()=>s});const s=r.p+"assets/images/example_keypad8-d5a816cbb4ef2a335ad33683addded8f.png"},6580:(e,n,r)=>{r.d(n,{c:()=>s});const s=r.p+"assets/images/example_keypad9-348f395a1584b309d13bcd7cdf4eb105.png"}}]);